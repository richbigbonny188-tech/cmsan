# Инструмент для Полного Аудита Безопасности Веб-Приложения

## О проекте

Данный инструмент предназначен для проведения полностью авторизованного white-box аудита безопасности веб-приложения Gambio e-commerce.

Все анализы являются легальными и предназначены исключительно для ответственного раскрытия информации владельцу системы.

## Целевое приложение

- **Название**: Gambio E-commerce
- **Версия**: 4.9.4.1
- **Стек**: PHP 7.x+, MySQL, JavaScript
- **Архитектура**: MVC-based e-commerce platform

## Цель

Идентифицировать ТОЛЬКО реальные, доказуемые уязвимости безопасности, которые достижимы из любой внешней точки входа и могут быть продемонстрированы с фактическими доказательствами.

Спекуляции запрещены.

## Глобальные ограничения (строгие)

- ❌ Никаких спекуляций или гипотетических атак
- ❌ Не предоставлять best practices или общие советы
- ❌ Не включать массовое сканирование или автоматизированную эксплуатацию
- ❌ Не останавливаться на первой находке
- ✅ Если эксплуатируемость не может быть доказана → отбросить проблему
- ✅ Если эксплуатируемых уязвимостей не существует → явно заявить об этом

## Структура инструмента

```
security_audit/
├── README.md                          # Этот файл
├── audit_main.py                      # Главный скрипт аудита
├── phase1_entrypoint_mapper.py        # Фаза 1: Картирование точек входа
├── phase2_dataflow_tracer.py          # Фаза 2: Трассировка потока данных
├── phase3_control_filter.py           # Фаза 3: Фильтр устранения контроля
├── phase4_exploitability.py           # Фаза 4: Анализ эксплуатируемости
├── phase5_chain_analyzer.py           # Фаза 5: Анализатор цепочек
├── report_generator.py                # Генератор отчётов
├── config.yaml                        # Конфигурация аудита
└── results/                           # Директория с результатами
    ├── entrypoints.json
    ├── dataflows.json
    ├── vulnerabilities.json
    └── final_report.md
```

## Использование

```bash
# Запуск полного аудита
python3 security_audit/audit_main.py --target /path/to/gambio

# Запуск отдельных фаз
python3 security_audit/phase1_entrypoint_mapper.py --target /path/to/gambio
python3 security_audit/phase2_dataflow_tracer.py --entrypoints results/entrypoints.json
python3 security_audit/phase3_control_filter.py --dataflows results/dataflows.json
python3 security_audit/phase4_exploitability.py --filtered results/filtered_flows.json
python3 security_audit/phase5_chain_analyzer.py --vulns results/vulnerabilities.json

# Генерация финального отчёта
python3 security_audit/report_generator.py --all-results results/
```

## Обязательные области анализа — точки входа

### A) Сеть / Транспорт
- HTTP / HTTPS (все методы, различия HTTP/1.1 и HTTP/2)
- Server-to-server callbacks (webhooks, IPN, endpoints обновления/лицензирования)
- Внутренний HTTP, достижимый через SSRF
- TLS termination / доверенные заголовки прокси

### B) Маршрутизация приложения
- Frontend-контроллеры (index.php, shop.php, параметры маршрутизации)
- Endpoints вне /admin с admin-функциональностью
- Endpoints инсталлятора / обновления / обслуживания
- AJAX / JSON / XHR handlers
- API-подобные endpoints (паттерны method/handler/action)

### C) Не-HTTP пути (достижимые через HTTP-эффекты)
- Запись в файловую систему (uploads, backups, restores, updates, cache, temp)
- Includes / requires / stream wrappers
- Cron / worker / task endpoints, вызываемые через HTTP
- Пути обработки email (SMTP → DB → templates)
- Внешние сервисы (FTP, S3, update mirrors)

### D) Мосты на стороне клиента
- Stored / reflected injection, достигающие браузеров
- Раскрытие токена/сессии, позволяющее воспроизведение привилегий

## Методология (5 фаз)

### Фаза 1: Картирование точек входа
Для КАЖДОЙ точки входа:
- Путь к файлу
- Handler / функция
- Транспорт (HTTP, callback, file-triggered, client-side)
- Метод(ы)
- Параметры
- Аутентификация / предположение доверия

Только картирование. Никаких выводов о безопасности.

### Фаза 2: Полная трассировка потока данных
Для КАЖДОГО параметра:
- [ТОЧКА ВХОДА]
- [ИСТОЧНИК]
- [ТРАНСФОРМАЦИИ] (casting, encoding/decoding, concatenation, filtering/validation, trust assumptions)
- [СТОК]
- [КОНТРОЛЬ ПОЛЬЗОВАТЕЛЯ СОХРАНЁН: ДА / НЕТ]

Трассировка до финального эффекта (DB, FS, include, command, response, browser).

### Фаза 3: Фильтр устранения контроля
Отбросить потоки, где контроль пользователя полностью устранён.
Для каждого отброса:
- Точная строка/функция, где контроль утрачен
- Причина (type cast, whitelist, hard stop)

### Фаза 4: Эксплуатируемость (только факты)
Для оставшихся потоков:
- Точный класс уязвимости
- Точное условие, которое позволяет эксплуатацию
- Наблюдаемое воздействие (что изменяется, где)
- Доказательства, необходимые для подтверждения (логи, изменение ответа, создание файла, изменение состояния)

### Фаза 5: Цепочки (только если доказуемо)
Если и только если каждый шаг доказуем:
[Entrypoint] → [Промежуточный эффект] → [Финальное воздействие]

Немедленная остановка, если любое звено не может быть доказано.

## Требования к финальному отчёту

Для каждой подтверждённой уязвимости:
- Затронутая точка(и) входа
- Точное воздействие
- Необходимые доказательства
- Почему это важно в реальных условиях

Если уязвимостей, соответствующих критериям, не найдено:
Явно заявить: "Эксплуатируемые уязвимости не были доказаны."

## Лицензия

Инструмент предназначен исключительно для авторизованного тестирования безопасности.
