"use strict";!function(){var e=!1,n=function(){var n=KlarnaHub.Config.klarnaOrder;if(n){var r=$("#update_orders_status_form"),a=r.find('[name="gm_status"]'),t=r.find(".single-checkbox:first").parent(),i=t.clone(!0);i.addClass("hidden"),i.find("label").text(KlarnaHub.Config.lang.NOTIFY_KLARNA);var d=i.find(".single-checkbox"),u=i.find("input");u.attr("name","gm_notify_klarna"),i.insertBefore(t.next()),n.order_lines.filter((function(e){var n=function(e){return KlarnaHub.Config.klarnaOrder.captures.find((function(n){return n.order_lines.find((function(n){return null!==n.merchant_data?n.merchant_data===e.merchant_data:n.reference===e.reference}))}))}(e);return"ot_coupon"!==e.reference&&"ot_discount"!==e.reference&&"ot_gv"!==e.reference&&!n})).length||d.addClass("disabled"),r.on("submit",(function(n){if(n.preventDefault(),!e)if(a.val()&&a.val()!=KlarnaHub.Config.orderStatusShipped||!u.prop("checked"))r[0].submit();else{var t=[];$("#klarna-selected-entries input:checkbox:checked").each((function(e,n){t.push($(n).data())})),t.length?(e=!0,KlarnaHub.Api.executeCapture(t).then((function(){return r[0].submit()})).finally((function(){return e=!1}))):r[0].submit()}})),a.on("change",(function(e){e.target.value&&e.target.value==KlarnaHub.Config.orderStatusShipped?(i.removeClass("hidden"),u.prop("checked",!0),d.hasClass("disabled")||d.addClass("checked")):(i.addClass("hidden"),u.prop("checked",!1),d.removeClass("checked"))})),KlarnaHub.trigger("module",{module:"extend_order_status_modal"})}};KlarnaHub.on("ready",(function(){return n()}))}();