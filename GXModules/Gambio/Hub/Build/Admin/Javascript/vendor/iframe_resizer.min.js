"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){if("undefined"!=typeof window){var n,i=0,t=!1,o=!1,r="message".length,a="[iFrameSizer]",s=a.length,d=null,c=window.requestAnimationFrame,u={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},f={},l=null,m={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){k("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}},g={};window.jQuery&&((n=window.jQuery).fn?n.fn.iFrameResize||(n.fn.iFrameResize=function(e){return this.filter("iframe").each((function(n,i){W(i,e)})).end()}):v("","Unable to bind to jQuery, it is not fully loaded.")),"function"==typeof define&&define.amd?define([],q):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=q():window.iFrameResize=window.iFrameResize||q()}function w(e,n,i){"addEventListener"in window?e.addEventListener(n,i,!1):"attachEvent"in window&&e.attachEvent("on"+n,i)}function h(e,n,i){"removeEventListener"in window?e.removeEventListener(n,i,!1):"detachEvent"in window&&e.detachEvent("on"+n,i)}function p(e){return a+"["+function(e){var n="Host page: "+e;return window.top!==window.self&&(n=window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e),n}(e)+"]"}function b(e){return f[e]?f[e].log:t}function y(e,n){F("log",e,n,b(e))}function v(e,n){F("info",e,n,b(e))}function k(e,n){F("warn",e,n,!0)}function F(e,n,i,t){!0===t&&"object"===_typeof(window.console)&&console[e](p(n),i)}function I(e){function n(){i("Height"),i("Width"),T((function(){O(W),R(P),m("resizedCallback",W)}),W,"init")}function i(e){var n=Number(f[P]["max"+e]),i=Number(f[P]["min"+e]),t=e.toLowerCase(),o=Number(W[t]);y(P,"Checking "+t+" is in range "+i+"-"+n),o<i&&(o=i,y(P,"Set "+t+" to min value")),o>n&&(o=n,y(P,"Set "+t+" to max value")),W[t]=""+o}function t(e){return I.substr(I.indexOf(":")+r+e)}function o(e,n){var i,t,o;i=function(){var i,t;S("Send Page Info","pageInfo:"+(i=document.body.getBoundingClientRect(),t=W.iframe.getBoundingClientRect(),JSON.stringify({iframeHeight:t.height,iframeWidth:t.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(t.top-i.top,10),offsetLeft:parseInt(t.left-i.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset})),e,n)},t=32,g[o=n]||(g[o]=setTimeout((function(){g[o]=null,i()}),t))}function c(e){var n=e.getBoundingClientRect();return z(P),{x:Math.floor(Number(n.left)+Number(d.x)),y:Math.floor(Number(n.top)+Number(d.y))}}function u(e){var n=e?c(W.iframe):{x:0,y:0},i={x:Number(W.width)+n.x,y:Number(W.height)+n.y};y(P,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](i.x,i.y):k(P,"Unable to scroll to requested position, window.parentIFrame not found"):(d=i,l(),y(P,"--"))}function l(){!1!==m("scrollCallback",d)?R(P):C()}function m(e,n){return x(P,e,n)}var p,b,F,I=e.data,W={},P=null;"[iFrameResizerChild]Ready"===I?function(){for(var e in f)S("iFrame requested init",N(e),document.getElementById(e),e)}():a===(""+I).substr(0,s)&&I.substr(s).split(":")[0]in f?(F=I.substr(s).split(":"),W={iframe:f[F[0]]&&f[F[0]].iframe,id:F[0],height:F[1],width:F[2],type:F[3]},P=W.id,f[P]&&(f[P].loaded=!0),(b=W.type in{true:1,false:1,undefined:1})&&y(P,"Ignoring init message from meta parent page"),!b&&function(e){var n=!0;return f[e]||(n=!1,k(W.type+" No settings for "+e+". Message was: "+I)),n}(P)&&(y(P,"Received: "+I),p=!0,null===W.iframe&&(k(P,"IFrame ("+W.id+") not found"),p=!1),p&&function(){var n,i=e.origin,t=f[P]&&f[P].checkOrigin;if(t&&""+i!="null"&&!(t.constructor===Array?function(){var e=0,n=!1;for(y(P,"Checking connection is from allowed list of origins: "+t);e<t.length;e++)if(t[e]===i){n=!0;break}return n}():(n=f[P]&&f[P].remoteHost,y(P,"Checking connection is from: "+n),i===n)))throw new Error("Unexpected message received from: "+i+" for "+W.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(f[P]&&f[P].firstRun&&f[P]&&(f[P].firstRun=!1),W.type){case"close":f[P].closeRequestCallback?x(P,"closeRequestCallback",f[P].iframe):M(W.iframe);break;case"message":g=t(6),y(P,"MessageCallback passed: {iframe: "+W.iframe.id+", message: "+g+"}"),m("messageCallback",{iframe:W.iframe,message:JSON.parse(g)}),y(P,"--");break;case"scrollTo":u(!1);break;case"scrollToOffset":u(!0);break;case"pageInfo":o(f[P]&&f[P].iframe,P),function(){function e(e,t){function r(){f[i]?o(f[i].iframe,i):n()}["scroll","resize"].forEach((function(n){y(i,e+n+" listener for sendPageInfo"),t(window,n,r)}))}function n(){e("Remove ",h)}var i=P;e("Add ",w),f[i]&&(f[i].stopPageInfo=n)}();break;case"pageInfoStop":f[P]&&f[P].stopPageInfo&&(f[P].stopPageInfo(),delete f[P].stopPageInfo);break;case"inPageLink":e=t(9),r=e.split("#")[1]||"",a=decodeURIComponent(r),(s=document.getElementById(a)||document.getElementsByName(a)[0])?(i=c(s),y(P,"Moving to in page link (#"+r+") at x: "+i.x+" y: "+i.y),d={x:i.x,y:i.y},l(),y(P,"--")):window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(r):y(P,"In page link #"+r+" not found and window.parentIFrame not found"):y(P,"In page link #"+r+" not found");break;case"reset":E(W);break;case"init":n(),m("initCallback",W.iframe);break;default:n()}var e,i,r,a,s,g}())):v(P,"Ignored: "+I)}function x(e,n,i){var t=null,o=null;if(f[e]){if("function"!=typeof(t=f[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=t(i)}return o}function M(e){var n=e.id;y(n,"Removing iFrame: "+n),e.parentNode&&e.parentNode.removeChild(e),x(n,"closedCallback",n),y(n,"--"),delete f[n]}function z(e){null===d&&y(e,"Get page position: "+(d={x:void 0!==window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop}).x+","+d.y)}function R(e){null!==d&&(window.scrollTo(d.x,d.y),y(e,"Set page position: "+d.x+","+d.y),C())}function C(){d=null}function E(e){y(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),z(e.id),T((function(){O(e),S("reset","reset",e.iframe,e.id)}),e,"reset")}function O(e){function n(n){o||"0"!==e[n]||(o=!0,y(t,"Hidden iFrame detected, creating visibility listener"),function(){function e(){function e(e){function n(n){return"0px"===(f[e]&&f[e].iframe.style[n])}f[e]&&null!==f[e].iframe.offsetParent&&(n("height")||n("width"))&&S("Visibility change","resize",f[e].iframe,e)}for(var n in f)e(n)}function n(n){y("window","Mutation observed: "+n[0].target+" "+n[0].type),P(e,16)}var i=window.MutationObserver||window.WebKitMutationObserver;i&&(t=document.querySelector("body"),new i(n).observe(t,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}));var t}())}function i(i){!function(n){e.iframe.style[n]=e[n]+"px",y(e.id,"IFrame ("+t+") "+n+" set to "+e[n]+"px")}(i),n(i)}var t=e.iframe.id;f[t]&&(f[t].sizeHeight&&i("height"),f[t].sizeWidth&&i("width"))}function T(e,n,i){i!==n.type&&c?(y(n.id,"Requesting animation frame"),c(e)):e()}function S(e,n,i,t,o){var r,s=!1;t=t||i.id,f[t]&&(i&&"contentWindow"in i&&null!==i.contentWindow?(r=f[t]&&f[t].targetOrigin,y(t,"["+e+"] Sending msg to iframe["+t+"] ("+n+") targetOrigin: "+r),i.contentWindow.postMessage(a+n,r)):k(t,"["+e+"] IFrame("+t+") not found"),o&&f[t]&&f[t].warningTimeout&&(f[t].msgTimeout=setTimeout((function(){!f[t]||f[t].loaded||s||(s=!0,k(t,"IFrame has not responded within "+f[t].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ingored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))}),f[t].warningTimeout)))}function N(e){return e+":"+f[e].bodyMarginV1+":"+f[e].sizeWidth+":"+f[e].log+":"+f[e].interval+":"+f[e].enablePublicMethods+":"+f[e].autoResize+":"+f[e].bodyMargin+":"+f[e].heightCalculationMethod+":"+f[e].bodyBackground+":"+f[e].bodyPadding+":"+f[e].tolerance+":"+f[e].inPageLinks+":"+f[e].resizeFrom+":"+f[e].widthCalculationMethod}function W(e,n){var o,r=function(o){var r;return o,""===o&&(e.id=(r=n&&n.id||m.id+i++,null!==document.getElementById(r)&&(r+=i++),o=r),t=(n||{}).log,o,y(o,"Added missing iframe ID: "+o+" ("+e.src+")")),o}(e.id);r in f&&"iFrameResizer"in e?k(r,"Ignored iFrame, already setup."):(!function(n){var i;n=n||{},f[r]={firstRun:!0,iframe:e,remoteHost:e.src.split("/").slice(0,3).join("/")},function(e){if("object"!==(void 0===e?"undefined":_typeof(e)))throw new TypeError("Options is not an object")}(n),function(e){for(var n in m)m.hasOwnProperty(n)&&(f[r][n]=e.hasOwnProperty(n)?e[n]:m[n])}(n),f[r]&&(f[r].targetOrigin=!0===f[r].checkOrigin?""===(i=f[r].remoteHost)||"file://"===i?"*":i:"*")}(n),function(){switch(y(r,"IFrame scrolling "+(f[r]&&f[r].scrolling?"enabled":"disabled")+" for "+r),e.style.overflow=!1===(f[r]&&f[r].scrolling)?"hidden":"auto",f[r]&&f[r].scrolling){case!0:e.scrolling="yes";break;case!1:e.scrolling="no";break;default:e.scrolling=f[r]?f[r].scrolling:"no"}}(),function(){function n(n){1/0!==f[r][n]&&0!==f[r][n]&&(e.style[n]=f[r][n]+"px",y(r,"Set "+n+" = "+f[r][n]+"px"))}function i(e){if(f[r]["min"+e]>f[r]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}i("Height"),i("Width"),n("maxHeight"),n("minHeight"),n("maxWidth"),n("minWidth")}(),"number"!=typeof(f[r]&&f[r].bodyMargin)&&"0"!==(f[r]&&f[r].bodyMargin)||(f[r].bodyMarginV1=f[r].bodyMargin,f[r].bodyMargin=f[r].bodyMargin+"px"),o=N(r),w(e,"load",(function(){var n,i;S("iFrame.onload",o,e,void 0,!0),n=f[r]&&f[r].firstRun,i=f[r]&&f[r].heightCalculationMethod in u,!n&&i&&E({iframe:e,height:0,width:0,type:"init"})})),S("init",o,e,void 0,!0),Function.prototype.bind&&f[r]&&(f[r].iframe.iFrameResizer={close:M.bind(null,f[r].iframe),resize:S.bind(null,"Window resize","resize",f[r].iframe),moveToAnchor:function(e){S("Move to anchor","moveToAnchor:"+e,f[r].iframe,r)},sendMessage:function(e){S("Send Message","message:"+(e=JSON.stringify(e)),f[r].iframe,r)}}))}function P(e,n){null===l&&(l=setTimeout((function(){l=null,e()}),n))}function H(e){y("window","Trigger event: "+e),P((function(){j("Window "+e,"resize")}),16)}function A(){"hidden"!==document.visibilityState&&(y("document","Trigger event: Visiblity change"),P((function(){j("Tab Visable","resize")}),16))}function j(e,n){function i(e){return f[e]&&"parent"===f[e].resizeFrom&&f[e].autoResize&&!f[e].firstRun}for(var t in f)i(t)&&S(e,n,document.getElementById(t),t)}function q(){function e(e,i){i&&(!function(){if(!i.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==i.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+i.tagName+">")}(),W(i,e),n.push(i))}var n;return function(){var e,n=["moz","webkit","o","ms"];for(e=0;e<n.length&&!c;e+=1)c=window[n[e]+"RequestAnimationFrame"];c||y("setup","RequestAnimationFrame not supported")}(),w(window,"message",I),w(window,"resize",(function(){H("resize")})),w(document,"visibilitychange",A),w(document,"-webkit-visibilitychange",A),w(window,"focusin",(function(){H("focus")})),w(window,"focus",(function(){H("focus")})),function(i,t){switch(n=[],function(e){e&&e.enablePublicMethods&&k("enablePublicMethods option has been removed, public methods are now always available in the iFrame")}(i),void 0===t?"undefined":_typeof(t)){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(t||"iframe"),e.bind(void 0,i));break;case"object":e(i,t);break;default:throw new TypeError("Unexpected data type ("+(void 0===t?"undefined":_typeof(t))+")")}return n}}}();