{load_language_text section="cashflowtech"}
<style>
	#newcollectionform table {
		width: 100%;
	}
	#newcollectionform table td.label {
		width: 40%;
	}
	#newcollectionform fieldset {
		display: block;
		margin: 0 0 1em 0;
		padding: 0;
	}
	#newcollectionform legend {
		font-weight: bold;
		margin: 1ex 0 0.5ex;
	}
	#newcollectionform input[type="text"],
	#newcollectionform select {
		width: 100%;
	}
	#newcollectionform input.amount {
		width: 10em;
	}
	#newcollectionform input[type="checkbox"] {
		margin-right: 1em;
		vertical-align: middle;
	}
	div.toggler {
		text-align: center;
	}
	div.toggler.open {
		display: none;
	}
	div#newcollectionform {
		display: none;
		transition: height 2s;
	}
</style>
<div class="toggler"><span class="btn">{$txt.create_new_collection}</span></div>
<div id="newcollectionform" class="">
	<h2>{$txt.create_new_collection}</h2>
	<form method="post" class="form-horizontal">
		<input type="hidden" name="action" value="new-collection">
		<input type="hidden" name="order_id" value="{$content_data.orderId}">
		<fieldset>
			<legend>Angaben zum Schuldner</legend>
			<table>
				<tr>
					<td class="label"><label for="reference_1" class="col-xs-3 control-label">{$txt.nc_reference_1}</label></td>
					<td>
						<input type="text"
							   id="nc-reference_1"
							   name="new-collection[reference_1]"
							   class="form-control"
							   value="{$content_data.collection_data.reference_1}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="reference_2" class="col-xs-3 control-label">{$txt.nc_reference_2}</label></td>
					<td>
						<input type="text"
							   id="nc-reference_2"
							   name="new-collection[reference_2]"
							   class="form-control"
							   value="{$content_data.collection_data.reference_2}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="reference_3" class="col-xs-3 control-label">{$txt.nc_reference_3}</label></td>
					<td>
						<input type="text"
							   id="nc-reference_3"
							   name="new-collection[reference_3]"
							   class="form-control"
							   value="{$content_data.collection_data.reference_3}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="salutation_id" class="col-xs-3 control-label">{$txt.nc_salutation_id}</label></td>
					<td>
						<select name="new-collection[person_data][salutation_id]" class="form-control">
							<option value="0" {if $content_data.collection_data.salutation_id === 0}selected{/if}>
								{$txt.nc_salutation_id_0}
							</option>
							<option value="1" {if $content_data.collection_data.salutation_id === 1}selected{/if}>
								{$txt.nc_salutation_id_1}
							</option>
							<option value="2" {if $content_data.collection_data.salutation_id === 2}selected{/if}>
								{$txt.nc_salutation_id_2}
							</option>
							<option value="3" {if $content_data.collection_data.salutation_id === 3}selected{/if}>
								{$txt.nc_salutation_id_3}
							</option>
							<option value="4" {if $content_data.collection_data.salutation_id === 4}selected{/if}>
								{$txt.nc_salutation_id_4}
							</option>
							<option value="5" {if $content_data.collection_data.salutation_id === 5}selected{/if}>
								{$txt.nc_salutation_id_5}
							</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="label"><label for="title_id" class="col-xs-3 control-label">{$txt.nc_title_id}</label></td>
					<td>
						<select name="new-collection[person_data][title_id]" class="form-control">
							<option value="0" {if $content_data.collection_data.title_id === 0}selected{/if}>
								{$txt.nc_title_id_0}
							</option>
							<option value="2" {if $content_data.collection_data.title_id === 2}selected{/if}>
								{$txt.nc_title_id_2}
							</option>
							<option value="3" {if $content_data.collection_data.title_id === 3}selected{/if}>
								{$txt.nc_title_id_3}
							</option>
							<option value="4" {if $content_data.collection_data.title_id === 4}selected{/if}>
								{$txt.nc_title_id_4}
							</option>
							<option value="5" {if $content_data.collection_data.title_id === 5}selected{/if}>
								{$txt.nc_title_id_5}
							</option>
							<option value="6" {if $content_data.collection_data.title_id === 6}selected{/if}>
								{$txt.nc_title_id_6}
							</option>
							<option value="7" {if $content_data.collection_data.title_id === 7}selected{/if}>
								{$txt.nc_title_id_7}
							</option>
							<option value="8" {if $content_data.collection_data.title_id === 8}selected{/if}>
								{$txt.nc_title_id_8}
							</option>
							<option value="9" {if $content_data.collection_data.title_id === 9}selected{/if}>
								{$txt.nc_title_id_9}
							</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-company" class="col-xs-3 control-label">{$txt.nc_company}</label></td>
					<td>
						<input type="text"
							   id="nc-company"
							   class="form-control"
							   name="new-collection[person_data][company]"
							   value="{$content_data.collection_data.company}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-company-type-id" class="col-xs-3 control-label">{$txt.nc_company_type_id}</label></td>
					<td>
						<select id="nc-company-type-id" name="new-collection[person_data][company_type_id]" class="form-control">
							<option value="0" {if $content_data.collection_data.company_type_id === 0}selected{/if}>
								{$txt.nc_company_type_id_0}
							</option>
							<option value="1" {if $content_data.collection_data.company_type_id === 1}selected{/if}>
								{$txt.nc_company_type_id_1}
							</option>
							<option value="2" {if $content_data.collection_data.company_type_id === 2}selected{/if}>
								{$txt.nc_company_type_id_2}
							</option>
							<option value="3" {if $content_data.collection_data.company_type_id === 3}selected{/if}>
								{$txt.nc_company_type_id_3}
							</option>
							<option value="4" {if $content_data.collection_data.company_type_id === 4}selected{/if}>
								{$txt.nc_company_type_id_4}
							</option>
							<option value="5" {if $content_data.collection_data.company_type_id === 5}selected{/if}>
								{$txt.nc_company_type_id_5}
							</option>
							<option value="6" {if $content_data.collection_data.company_type_id === 6}selected{/if}>
								{$txt.nc_company_type_id_6}
							</option>
							<option value="7" {if $content_data.collection_data.company_type_id === 7}selected{/if}>
								{$txt.nc_company_type_id_7}
							</option>
							<option value="8" {if $content_data.collection_data.company_type_id === 8}selected{/if}>
								{$txt.nc_company_type_id_8}
							</option>
							<option value="9" {if $content_data.collection_data.company_type_id === 9}selected{/if}>
								{$txt.nc_company_type_id_9}
							</option>
							<option value="10" {if $content_data.collection_data.company_type_id === 10}selected{/if}>
								{$txt.nc_company_type_id_10}
							</option>
							<option value="11" {if $content_data.collection_data.company_type_id === 11}selected{/if}>
								{$txt.nc_company_type_id_11}
							</option>
							<option value="12" {if $content_data.collection_data.company_type_id === 12}selected{/if}>
								{$txt.nc_company_type_id_12}
							</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-first_name" class="col-xs-3 control-label">{$txt.nc_first_name}</label></td>
					<td>
						<input type="text"
							   id="nc-first_name"
							   class="form-control"
							   name="new-collection[person_data][first_name]"
							   value="{$content_data.collection_data.first_name}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-last_name" class="col-xs-3 control-label">{$txt.nc_last_name}</label></td>
					<td>
						<input type="text"
							   id="nc-last_name"
							   class="form-control"
							   name="new-collection[person_data][last_name]"
							   value="{$content_data.collection_data.last_name}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-maiden_name" class="col-xs-3 control-label">{$txt.nc_maiden_name}</label></td>
					<td>
						<input type="text"
							   id="nc-maiden_name"
							   class="form-control"
							   name="new-collection[person_data][maiden_name]"
							   value="{$content_data.collection_data.maiden_name}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-street" class="col-xs-3 control-label">{$txt.nc_street}</label></td>
					<td>
						<input type="text"
							   id="nc-street"
							   class="form-control"
							   name="new-collection[person_data][street]"
							   value="{$content_data.collection_data.street}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-housenumber" class="col-xs-3 control-label">{$txt.nc_housenumber}</label></td>
					<td>
						<input type="text"
							   id="nc-housenumber"
							   class="form-control"
							   name="new-collection[person_data][housenumber]"
							   value="{$content_data.collection_data.housenumber}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-postalcode" class="col-xs-3 control-label">{$txt.nc_postalcode}</label></td>
					<td>
						<input type="text"
							   id="nc-postalcode"
							   class="form-control"
							   name="new-collection[person_data][postalcode]"
							   value="{$content_data.collection_data.postalcode}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-city" class="col-xs-3 control-label">{$txt.nc_city}</label></td>
					<td>
						<input type="text"
							   id="nc-city"
							   class="form-control"
							   name="new-collection[person_data][city]"
							   value="{$content_data.collection_data.city}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-country" class="col-xs-3 control-label">{$txt.nc_country}</label></td>
					<td>
						<input type="text"
							   id="nc-country"
							   class="form-control"
							   name="new-collection[person_data][country]"
							   value="{$content_data.collection_data.country}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-day_of_birth" class="col-xs-3 control-label">{$txt.nc_day_of_birth}</label></td>
					<td>
						<input type="date"
							   id="nc-day_of_birth"
							   class="form-control"
							   name="new-collection[person_data][day_of_birth]"
							   value="{$content_data.collection_data.date_of_birth}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-email" class="col-xs-3 control-label">{$txt.nc_email}</label></td>
					<td>
						<input type="text"
							   id="nc-email"
							   class="form-control"
							   name="new-collection[person_data][email]"
							   value="{$content_data.collection_data.email}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-phone" class="col-xs-3 control-label">{$txt.nc_phone}</label></td>
					<td>
						<input type="text"
							   id="nc-phone"
							   class="form-control"
							   name="new-collection[person_data][phone]"
							   value="{$content_data.collection_data.phone}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-mobile" class="col-xs-3 control-label">{$txt.nc_mobile}</label></td>
					<td>
						<input type="text"
							   id="nc-mobile"
							   class="form-control"
							   name="new-collection[person_data][mobile]"
							   value="{$content_data.collection_data.mobile}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-fax" class="col-xs-3 control-label">{$txt.nc_fax}</label></td>
					<td>
						<input type="text"
							   id="nc-fax"
							   class="form-control"
							   name="new-collection[person_data][fax]"
							   value="{$content_data.collection_data.fax}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-account_number" class="col-xs-3 control-label">{$txt.nc_account_number}</label></td>
					<td>
						<input type="text"
							   id="nc-account_number"
							   class="form-control"
							   name="new-collection[person_data][account_number]"
							   value="{$content_data.collection_data.account_number}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-bank_number" class="col-xs-3 control-label">{$txt.nc_bank_number}</label></td>
					<td>
						<input type="text"
							   id="nc-bank_number"
							   class="form-control"
							   name="new-collection[person_data][bank_number]"
							   value="{$content_data.collection_data.bank_number}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-account_iban" class="col-xs-3 control-label">{$txt.nc_account_iban}</label></td>
					<td>
						<input type="text"
							   id="nc-account_iban"
							   class="form-control"
							   name="new-collection[person_data][account_iban]"
							   value="{$content_data.collection_data.account_iban}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-bank_bic" class="col-xs-3 control-label">{$txt.nc_bank_bic}</label></td>
					<td>
						<input type="text"
							   id="nc-bank_bic"
							   class="form-control"
							   name="new-collection[person_data][bank_bic]"
							   value="{$content_data.collection_data.bank_bic}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-account_owner_first_name" class="col-xs-3 control-label">{$txt.nc_account_owner_first_name}</label></td>
					<td>
						<input type="text"
							   id="nc-account_owner_first_name"
							   class="form-control"
							   name="new-collection[person_data][account_owner_first_name]"
							   value="{$content_data.collection_data.account_owner_first_name}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-account_owner_last_name" class="col-xs-3 control-label">{$txt.nc_account_owner_last_name}</label></td>
					<td>
						<input type="text"
							   id="nc-account_owner_last_name"
							   class="form-control"
							   name="new-collection[person_data][account_owner_last_name]"
							   value="{$content_data.collection_data.account_owner_last_name}">
					</td>
				</tr>
			</table>
		</fieldset>
		<fieldset>
			<legend>Angaben zur Forderung</legend>
			<table>
				<tr>
					<td class="label"><label for="nc-bd-type" class="col-xs-3 control-label">Art der Forderung</label></td>
					<td>
						<select id="nc-bd-type" name="new-collection[booking_data][0][type]" class="form-control">
							<option value="1" selected>Hauptforderung</option>
							<option value="2">BRLS Gebühr</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-bd-ext_id" class="col-xs-3 control-label">Referenz zur Buchung</label></td>
					<td>
						<input type="text"
							   id="nc-bd-ext_id"
							   class="form-control"
							   name="new-collection[booking_data][0][ext_id]"
							   value="{$content_data.collection_data.ext_id}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-bd-invoice_nr" class="col-xs-3 control-label">Rechnungsnummer zur Forderung</label></td>
					<td>
						<input type="text"
							   id="nc-bd-invoice_nr"
							   class="form-control"
							   name="new-collection[booking_data][0][invoice_nr]"
							   value="{$content_data.collection_data.invoice_nr}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-bd-booking_date" class="col-xs-3 control-label">Buchungsdatum</label></td>
					<td>
						<input type="date"
							   required
							   id="nc-bd-booking_date"
							   class="form-control"
							   name="new-collection[booking_data][0][booking_date]"
							   value="{$content_data.collection_data.booking_date}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-bd-due_date" class="col-xs-3 control-label">Fälligkeitsdatum</label></td>
					<td>
						<input type="date"
							   required
							   id="nc-bd-due_date"
							   class="form-control"
							   name="new-collection[booking_data][0][due_date]"
							   value="{$content_data.collection_data.due_date}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-bd-order_date" class="col-xs-3 control-label">Bestelldatum</label></td>
					<td>
						<input type="date"
							   required
							   id="nc-bd-order_date"
							   class="form-control"
							   name="new-collection[booking_data][0][order_date]"
							   value="{$content_data.collection_data.order_date}">
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-bd-amount" class="col-xs-3 control-label">Betrag (Forderungshöhe)</label></td>
					<td>
						<input type="text"
							   id="nc-bd-amount"
							   class="form-control amount"
							   name="new-collection[booking_data][0][amount]"
							   value="{$content_data.collection_data.amount}">
						EUR
					</td>
				</tr>
				<tr>
					<td class="label"><label for="nc-bd-description" class="col-xs-3 control-label">Beschreibung</label></td>
					<td>
						<input type="text"
							   id="nc-bd-description"
							   class="form-control"
							   name="new-collection[booking_data][0][description]"
							   value="{$content_data.collection_data.description}">
					</td>
				</tr>
			</table>
		</fieldset>
		{if $content_data.invoices}
			<input type="hidden" name="invoiceData" value="{$content_data.invoice_data}">
			<fieldset>
				<legend>Dokumente</legend>
				<table>
					<tr>
						<td class="label"><label for="nc-invoices" class="col-xs-3 control-label">{$txt.nc_invoices_to_include}</label></td>
						<td>
							{foreach from=$content_data.invoices item=invoice}
								<div class="">
									<input id="invoice-{$invoice.invoiceId}" type="checkbox" class="" name="invoices[]" value="{$invoice.invoiceId}">
									<label for="invoice-{$invoice.invoiceId}">
										{$invoice.invoiceNumber} ({$invoice['invoiceDateReadable']})
									</label><br>
								</div>
							{/foreach}
						</td>
					</tr>
				</table>
			</fieldset>
		{/if}
		<div class="form-group">
			<div class="col-xs-offset-8 col-xs-4 text-right">
				<button class="btn btn-primary">{$txt.create_new_collection}</button>
			</div>
		</div>
	</form>
</div>
<script>
$(function() {
	'use strict';

	$('div.toggler').on('click', function(e) {
		let $this = $(this);
		$this.toggleClass('open');
		$('div#newcollectionform').toggle('fast');
	});
});
</script>
