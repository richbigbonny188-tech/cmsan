{extends file="get_usermod:layouts/main/layout.html"}

{block name="content"}
	{load_language_text section="module_center_module"}
	{load_language_text section="countries" name="txtcountries"}
	<div class="breakpoint-small">
		<form action="{$content.action_save_mandator}" method="POST" class="form-configuration">
			<input type="hidden" name="pageToken" value="{$content.pageToken}">
			<div class="form-horizontal">
				<fieldset>
					{if $content.mandator_id}{* mandator created, allow change of mandator ID *}
						<legend>{$txt.cashflowtech_mcm_configuration}</legend>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_mandator_id">{$txt.cashflowtech_mcm_mandator_id}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="mandator_id"
									   id="cft_mandator_id" value="{$content.person_data['mandator_id']}">
							</div>
						</div>
					{else}
						<legend>{$txt.cashflowtech_mcm_mandator_onboarding}</legend>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_salutation_id">{$txt.cashflowtech_mcm_salutation_id}</label>
							<div class="col-sm-8">
								<select class="form-control" name="person_data[salutation_id]" id="cft_salutation_id">
									<option value="0"{if $content.person_data['salutation_id'] == '0'} selected{/if}>(keine)</option>
									<option value="1"{if $content.person_data['salutation_id'] == '1'} selected{/if}>Herr</option>
									<option value="2"{if $content.person_data['salutation_id'] == '2'} selected{/if}>Frau</option>
									<option value="3"{if $content.person_data['salutation_id'] == '3'} selected{/if}>Firma</option>
									<option value="4"{if $content.person_data['salutation_id'] == '4'} selected{/if}>Mr.</option>
									<option value="5"{if $content.person_data['salutation_id'] == '5'} selected{/if}>Mrs.</option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_title_id">{$txt.cashflowtech_mcm_title_id}</label>
							<div class="col-sm-8">
								<select class="form-control" name="person_data[title_id]" id="cft_title_id">
									<option value="1"{if $content.person_data['title_id'] == '0'} selected{/if}>â€“</option>
									<option value="2"{if $content.person_data['title_id'] == '2'} selected{/if}>Dr.</option>
									<option value="3"{if $content.person_data['title_id'] == '3'} selected{/if}>Prof.</option>
									<option value="4"{if $content.person_data['title_id'] == '4'} selected{/if}>Prof. Dr.</option>
									<option value="5"{if $content.person_data['title_id'] == '5'} selected{/if}>Dr. med.</option>
									<option value="6"{if $content.person_data['title_id'] == '6'} selected{/if}>Dipl.-Ing.</option>
									<option value="7"{if $content.person_data['title_id'] == '7'} selected{/if}>Dr. rer. nat.</option>
									<option value="8"{if $content.person_data['title_id'] == '8'} selected{/if}>Dr. iur.</option>
									<option value="9"{if $content.person_data['title_id'] == '9'} selected{/if}>Mag.</option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_company">{$txt.cashflowtech_mcm_company}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[company]"
									   id="cft_company" value="{$content.person_data['company']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_company_id">{$txt.cashflowtech_mcm_company_type_id}</label>
							<div class="col-sm-8">
								<select class="form-control" name="person_data[company_type_id]" id="cft_company_type_id">
									<option value="1"{if $content.person_data['company_type_id'] == '1'} selected{/if}>Einzelunternehmen</option>
									<option value="2"{if $content.person_data['company_type_id'] == '2'} selected{/if}>Stille Gesellschaft</option>
									<option value="3"{if $content.person_data['company_type_id'] == '3'} selected{/if}>OHG</option>
									<option value="4"{if $content.person_data['company_type_id'] == '4'} selected{/if}>KG</option>
									<option value="5"{if $content.person_data['company_type_id'] == '5'} selected{/if}>GbR (BGB-Gesellschaft)</option>
									<option value="6"{if $content.person_data['company_type_id'] == '6'} selected{/if}>AG</option>
									<option value="7"{if $content.person_data['company_type_id'] == '7'} selected{/if}>KGaA</option>
									<option value="8"{if $content.person_data['company_type_id'] == '8'} selected{/if}>GmbH</option>
									<option value="9"{if $content.person_data['company_type_id'] == '9'} selected{/if}>eG</option>
									<option value="10"{if $content.person_data['company_type_id'] == '10'} selected{/if}>GmbH & Co. KG</option>
									<option value="11"{if $content.person_data['company_type_id'] == '11'} selected{/if}>e.V.</option>
									<option value="12"{if $content.person_data['company_type_id'] == '12'} selected{/if}>UG</option>
								</select>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_first_name">{$txt.cashflowtech_mcm_first_name}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[first_name]"
									   id="cft_first_name" value="{$content.person_data['first_name']}" required>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_last_name">{$txt.cashflowtech_mcm_last_name}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[last_name]"
									   id="cft_last_name" value="{$content.person_data['last_name']}" required>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_maiden_name">{$txt.cashflowtech_mcm_maiden_name}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[maiden_name]"
									   id="cft_maiden_name" value="{$content.person_data['maiden_name']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_street">{$txt.cashflowtech_mcm_street}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[street]"
									   id="cft_street" value="{$content.person_data['street']}" required>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_housenumber">{$txt.cashflowtech_mcm_housenumber}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[housenumber]"
									   id="cft_housenumber" value="{$content.person_data['housenumber']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_postalcode">{$txt.cashflowtech_mcm_postalcode}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[postalcode]"
									   id="cft_postalcode" value="{$content.person_data['postalcode']}" required>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_city">{$txt.cashflowtech_mcm_city}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[city]"
									   id="cft_city" value="{$content.person_data['city']}" required>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_country">{$txt.cashflowtech_mcm_country}</label>
							<div class="col-sm-8">
								<select class="form-control" name="person_data[country]" id="cft_country">
									{foreach from=$content.countries item=country}
										<option value="{$country.countries_iso_code_2}"{if $content.person_data['country'] == $country.countries_iso_code_2} selected{/if}>
											{$txtcountries[$country.countries_iso_code_2]}
										</option>
									{/foreach}
								</select>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_day_of_birth">{$txt.cashflowtech_mcm_day_of_birth}</label>
							<div class="col-sm-8">
								<input type="text"
									   class="form-control"
									   name="person_data[day_of_birth]"
									   id="cft_day-of-birth"
									   value="{$content.person_data['day_of_birth']}"
									   placeholder="{$content.day_of_birth}"
									   data-jse-widget="datepicker"
									   data-datepicker-format="yy-mm-dd"
									   data-datepicker-year-range="-110:+0"
									   data-datepicker-show-On="focus"
									   data-datepicker-gx-container
								>
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_email">{$txt.cashflowtech_mcm_email}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[email]"
									   id="cft_email" value="{$content.person_data['email']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_phone">{$txt.cashflowtech_mcm_phone}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[phone]"
									   id="cft_phone" value="{$content.person_data['phone']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_mobile">{$txt.cashflowtech_mcm_mobile}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[mobile]"
									   id="cft_mobile" value="{$content.person_data['mobile']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_fax">{$txt.cashflowtech_mcm_fax}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[fax]"
									   id="cft_fax" value="{$content.person_data['fax']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_account_number">{$txt.cashflowtech_mcm_account_number}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[account_number]"
									   id="cft_account_number" value="{$content.person_data['account_number']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_bank_number">{$txt.cashflowtech_mcm_bank_number}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[bank_number]"
									   id="cft_bank_number" value="{$content.person_data['bank_number']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_account_iban">{$txt.cashflowtech_mcm_account_iban}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[account_iban]"
									   id="cft_account_iban" value="{$content.person_data['account_iban']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_bank_bic">{$txt.cashflowtech_mcm_bank_bic}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[bank_bic]"
									   id="cft_bank_bic" value="{$content.person_data['bank_bic']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_account_owner_first_name">{$txt.cashflowtech_mcm_account_owner_first_name}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[account_owner_first_name]"
									   id="cft_account_owner_first_name" value="{$content.person_data['account_owner_first_name']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_account_owner_last_name">{$txt.cashflowtech_mcm_account_owner_last_name}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[account_owner_last_name]"
									   id="cft_account_owner_last_name" value="{$content.person_data['account_owner_last_name']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_tax_id">{$txt.cashflowtech_mcm_tax_id}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[tax_id]"
									   id="cft_tax_id" value="{$content.person_data['tax_id']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_trade_register_city">{$txt.cashflowtech_mcm_trade_register_city}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[trade_register_city]"
									   id="cft_trade_register_city" value="{$content.person_data['trade_register_city']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label" for="cft_trade_register_number">{$txt.cashflowtech_mcm_trade_register_number}</label>
							<div class="col-sm-8">
								<input type="text" class="form-control" name="person_data[trade_register_number]"
									   id="cft_trade_register_number" value="{$content.person_data['trade_register_number']}">
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label">{$txt.cashflowtech_mcm_tos}</label>
							<div class="col-sm-1">
								<input type="checkbox" name="confirmation[tos]" class="cft_tos_confirm" id="cft_tos_confirm">
							</div>
							<div class="col-sm-7">
								<label for="cft_tos_confirm">{$content.tos_text nofilter}</label>
							</div>
						</div>
					{/if}
				</fieldset>
				<div class="row">
					<div class="col-sm-12">
						<button type="submit" class="btn btn-primary pull-right">{$txt.cashflowtech_mcm_savemandator}</button>
					</div>
				</div>
			</div>
		</form>
	</div>
	{block name="cft_tos"}
		<div id="cft_tos">
			<div class="cft_layer">
				<div class="cft_overlay_container">
					<div class="cft_layer_close"><i class="far fa-times-circle"></i></div>
					<div class="cft_overlay_content">
						<iframe src="https://www.cashflowtech.de/agb/" style="width: 100%; height: 100%;" frameBorder="0"></iframe>
					</div>
				</div>
			</div>
		</div>
	{/block}
	{block name="cft_privacy"}
		<div id="cft_privacy">
			<div class="cft_layer">
				<div class="cft_overlay_container">
					<div class="cft_layer_close"><i class="far fa-times-circle"></i></div>
					<div class="cft_overlay_content">
						<iframe src="https://www.cashflowtech.de/datenschutz/" style="width: 100%; height: 100%;" frameBorder="0"></iframe>
					</div>
				</div>
			</div>
		</div>
	{/block}
	<style>
		input.cft_tos_confirm {
			vertical-align: middle;
		}
		#cft_tos, #cft_privacy {
			display: none;
		}
		.cft_layer {
			position: fixed;
			top: 0; bottom: 0; left: 0; right: 0;
			background: rgba(0,0,0,0.8);
			z-index: 9999;
			display: grid;
			align-items: center;
			grid-template-areas: "a";
		}
		.cft_layer .cft_overlay_container {
			position: relative;
			grid-area: a;
			margin: auto;
			width: 80%;
			height: 90%;
			background: #ffffff;
		}
		.cft_layer .cft_overlay_container .cft_layer_close {
			width: 20px;
			height: 20px;
			position: absolute;
			right: -30px;
			top: 0px;
			color: #ffffff;
			font-size: 20px;
		}
		.cft_layer .cft_overlay_content {
			background: #f0f0f0;
			position:   absolute;
			left:       1em;
			right:      1em;
			top:        1em;
			bottom:     1em;
			padding:    1em;
			overflow:   auto;
		}
	</style>
	<script>
		document.addEventListener('DOMContentLoaded', function() {
			let tosOverlay = document.querySelector('#cft_tos');
			let tosLink = document.querySelector('#cft_tos_link');
			tosLink.addEventListener('click', function(e) {
				e.preventDefault();
				tosOverlay.style.display = 'block';
			});
			let privacyOverlay = document.querySelector('#cft_privacy');
			let privacyLink = document.querySelector('#cft_privacy_link');
			privacyLink.addEventListener('click', function(e) {
				e.preventDefault();
				privacyOverlay.style.display = 'block';
			});
			let tosLayer = document.querySelector('#cft_tos .cft_layer');
			tosLayer.addEventListener('click', function(e) {
				if(e.target === tosLayer) {
					tosOverlay.style.display = 'none';
				}
			});
			let privacyLayer = document.querySelector('#cft_privacy .cft_layer');
			privacyLayer.addEventListener('click', function(e) {
				if(e.target === privacyLayer) {
					privacyOverlay.style.display = 'none';
				}
			});
			let tosClose = document.querySelector('#cft_tos .cft_layer_close');
			tosClose.addEventListener('click', function(e) {
				tosOverlay.style.display = 'none';
			});
			let privacyClose = document.querySelector('#cft_privacy .cft_layer_close');
			privacyClose.addEventListener('click', function(e) {
				privacyOverlay.style.display = 'none';
			});
		});
	</script>
{/block}
