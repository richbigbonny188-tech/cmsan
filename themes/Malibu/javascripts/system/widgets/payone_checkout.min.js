"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};gambio.widgets.module("payone_checkout",[],(function(e){var t=$(this),a=$.extend(!0,{},{},e),n={},o=function(e){"payone_cc"===$("form#checkout_payment").get(0).elements.payment.value&&(console.log("payone cc check triggered"),e.preventDefault(),p1cc_check())},l=function(){$('table.payone_elv_data select[name="p1_elv_country"]').on("change",(function(e){var t=$(this).val(),a=$("tr.only_de",$(this).closest("table"));"DE"==t?a.show("fast"):a.hide("fast")})),$('table.payone_elv_data select[name="p1_elv_country"]').trigger("change"),$(".sepadata input").on("change",(function(e){var t="";$(".sepadata input").each((function(){t+=$(this).val()})),0===t.length?$("tr.only_de input").removeAttr("disabled"):$("tr.only_de input").attr("disabled","disabled")})),$(".only_de input").on("change",(function(e){var t="";$(".only_de input").each((function(){t+=$(this).val()})),0===t.length?$("tr.sepadata input").removeAttr("disabled"):$("tr.sepadata input").attr("disabled","disabled")}));var e=function(e){console.log(e);var t=$("div.module_option_checked");if(e&&"object"==(void 0===e?"undefined":_typeof(e))&&"VALID"==e.status)a(),$("form#checkout_payment").trigger("submit");else{var n=p1_payment_error;"string"==typeof e.customermessage&&(n=e.customermessage),$("p.p1_error",t).html(n),$("p.p1_error",t).show(),t.closest("div.payment_item").removeClass("data_valid"),t.get(0).scrollIntoView()}},a=function(){var e=$('input[name="payment"]:checked');$("p.p1_error",e.closest("div.payment_item")).hide(),$("table.payone_elv_data").hide(),$("div.p1_finaldata_elv").show(),$("td.final_elv_country").html($("select#p1_elv_country option").filter(":selected").html()),$("td.final_elv_accountnumber").html($("input#p1_elv_accountnumber").val()),$("td.final_elv_bankcode").html($("input#p1_elv_bankcode").val()),$("td.final_elv_iban").html($("input#p1_elv_iban").val()),$("td.final_elv_bic").html($("input#p1_elv_bic").val()),e.closest("div.payment_item").addClass("data_valid"),$("table.payone_elv_data").removeClass("payone_paydata")};$("form#checkout_payment").on("submit",(function(n){var o=$('input[name="payment"]:checked');"payone_elv"===o.val()&&!1===o.closest("div.payment_item").hasClass("data_valid")&&function(n){var o=$('select[name="p1_elv_country"] option').filter(":selected").val(),l=$('input[name="p1_elv_accountnumber"]',t).val(),i=$('input[name="p1_elv_bankcode"]',t).val(),c=$('input[name="p1_elv_iban"]',t).val(),s=$('input[name="p1_elv_bic"]',t).val();if("none"==p1_elv_checkmode)a();else{n.preventDefault();var p=p1_elv_config,_=new PAYONE.Gateway(p,e),r={};r=c.length>0?{iban:c,bic:s,bankcountry:o}:{bankaccount:l,bankcode:i,bankcountry:o},console.log(r),_.call(r)}}(n)}))};return n.init=function(e){var t;console.log("payone_checkout module initializing, submodule "+a.module),"cc"==a.module&&$("form#checkout_payment").on("submit",o),"otrans"==a.module&&function(){$("select#otrans_type").on("change",(function(e){var t=$(this).val(),a=$(this).closest("table.payone_otrans_data");$("tr.datarow",a).hide(),$(".for_"+t).show(),"pfefinance"!=t&&"pfcard"!=t||($(this).closest("div.payment_item").addClass("data_valid"),$(this).closest("div.payment_item").click())})),$("select#otrans_type").trigger("change");var e=function(e){var t=!1;$('.payone_otrans_data input[type="text"]:visible').each((function(){""===$(this).val()&&(t=!0)})),!0===t?$("table.payone_otrans_data").addClass("payone_data_missing"):$("table.payone_otrans_data").removeClass("payone_data_missing"),$(this).closest("div.payment_item").removeClass("data_valid")};$('.payone_otrans_data input[type="text"]').keyup(e),$('.payone_otrans_data input[type="text"]').change(e)}(),"elv"==a.module&&l(),"safeinv"==a.module&&(t=function(){var e=$("#p1_safeinv_type").val();$("tr.p1-safeinv-agreement").not(".p1-show-for-"+e).hide(),$("tr.p1-show-for-"+e).show()},$('select[name="safeinv_type"]').on("change",t),t()),e()},n}));