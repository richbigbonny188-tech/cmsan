{* workarounds for old formatted messageStack messages *}

{block name="alert_message"}
	{assign var="errorImageName" value=$message|strval|regex_replace:"/(.+?)([a-z]+?)(\.gif.+)/s":"\\2"}
	
	{if $errorImageName === 'error' || $errorImageName === 'warning'}
		{assign var="type" value="danger"}
	{elseif $errorImageName === 'success'}
		{assign var="type" value="success"}
	{/if}
	
	{if $message || $hidden}
		{block name="alert_message_message"}
			<div class="alert alert-{if $type}{$type}{else}info{/if} {if $hidden}hidden{/if}">
				{if $allow_links==true}
                    {$message|replace:"&nbsp;":""}
				{else}
					{$message|strip_tags|replace:"&nbsp;":""}
				{/if}
			</div>
		{/block}
	{/if}
{/block}