"use strict";gambio.widgets.module("stickybox",[gambio.source+"/libs/events",gambio.source+"/libs/responsive"],(function(e){var t=$(this),o=$(window),s=null,n=null,i=null,r=null,l=null,p=null,a=null,c=null,u=null,f=null,m=null,g=null,h=null,d=null,b=null,x=0,v=!0,T=null,B=$.extend(!0,{},{breakpoint:60,outerWrapper:"#outer-wrapper",header:"header",footer:".product-info-listings, footer",offsetTopReferenceSelector:"#breadcrumb_navi, .product-info",marginTop:15,marginBottom:0,zIndex:1e3,cpuOptimization:!1,smoothness:10,smoothnessDelay:150,stage:"#stage",errorBox:"table.box-error, table.box-warning"},e),I={},k=function(){var e=t.offset().top-$(B.offsetTopReferenceSelector).first().offset().top,o=parseFloat(t.css("top"));u=o-e,w()},w=function(){t.removeAttr("style"),"md"===jse.libs.theme.responsive.breakpoint().name||"lg"===jse.libs.theme.responsive.breakpoint().name?t.css("top",u+"px"):t.css("top","")},y=function(e,i){if(B.cpuOptimization&&!i&&(x+=1,clearTimeout(g),!(x<B.smoothness?(g=setTimeout((function(){o.trigger("scroll.stickybox",!0)}),B.smoothnessDelay),0):(x=0,1))))return!0;if(jse.libs.theme.responsive.breakpoint().id>B.breakpoint){!function(){l=s.outerHeight(),r=n.offset().top,l+=B.marginTop,r-=B.marginBottom,p=t.outerHeight(),a=t.outerWidth(),c=c||t.offset(),$(document).height();var e=B.marginTop;f&&(e=l),m={position:"fixed",top:e+"px",left:c.left+"px","z-index":B.zIndex,width:a}}();var u=o.scrollTop();(v&&(v=!1,w(),window.setTimeout((function(){v=!0}),100),T=document.documentElement.clientHeight-document.getElementById("header").offsetHeight),T>p)&&function(e){if(f){var o=e+l+p+B.marginBottom-r,s=parseFloat(t.css("top")),n=h-(d-l)+e;n=n<h?h:n,n-=o-l,l+e<=c.top?w():o>0?r-e<p+d-h?(n=r-p-d+h-b,w(),t.css({top:n+"px"})):Math.abs(s-n)>=.5&&(w(),t.css({top:n+"px"})):"fixed"===t.css("position")&&t.css("top")===m.top||t.css(m)}else e<=c.top-B.marginTop?w():r-e+B.marginTop<p-h-B.marginTop?(n=r-p-d+h-b,w(),t.css({top:n+"px"})):"fixed"===t.css("position")&&t.css("top")===m.top||t.css(m)}(u)}},H=function(){w(),c=null,x=0,t.offset().top,y()};return I.init=function(e){var r=0,l=0,p=0,a=0;i=$(B.outerWrapper),s=$(B.header),n=$(B.footer),$(B.stage).length>0&&(r=$(B.stage).outerHeight()),$(B.errorBox).each((function(){p=parseInt($(this).css("margin-top"),10),a=parseInt($(this).css("margin-bottom"),10),l+=$(this).outerHeight(),l+=p,l+=a}));var c=$(B.errorBox).length;c>=2&&(l-=p*(c-1)),k(),t.offset().top,h=parseFloat(t.css("top")),d=s.outerHeight()+B.marginTop+r+l,b=parseFloat(i.css("margin-top").replace(/[^\d]/,"")),f="fixed"===s.css("position"),jse.core.config.get("mobile")?$("body").on(jse.libs.theme.events.BREAKPOINT(),k):(y(),o.on("resize",H).on("scroll.stickybox",y).on(jse.libs.theme.events.REPOSITIONS_STICKYBOX(),H)),e()},I}));