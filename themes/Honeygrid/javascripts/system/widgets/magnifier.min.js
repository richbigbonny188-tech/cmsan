"use strict";gambio.widgets.module("magnifier",[gambio.source+"/libs/responsive"],(function(e){var t=$(this),i=$("body"),a=null,n=!1,r=$.extend(!0,{},{target:null,keepInView:!0,bodyClass:"magnifier-active",breakpoint:60},e),o={},g=function(e){var t=$(this),i=t.data("magnifier"),o=a.children("img"),g=(i=i||function(e,t,i){var a={offset:e.offset(),height:e.height(),width:e.width(),targetWidth:t.width(),targetHeight:t.height(),imageWidth:i.width(),imageHeight:i.height()};return a.aspectX=-1/(a.width/a.imageWidth),a.aspectY=-1/(a.height/a.imageHeight),a.boundaryX=-1*(a.imageWidth-a.targetWidth),a.boundaryY=-1*(a.imageHeight-a.targetHeight),e.data("magnifier",a),n=!0,$.extend({},a)}(t,a,o)).aspectY*(e.pageY-i.offset.top)+i.targetHeight/2,s=i.aspectX*(e.pageX-i.offset.left)+i.targetWidth/2;r.keepInView&&(g=Math.min(0,g),g=Math.max(i.boundaryY,g),s=Math.min(0,s),s=Math.max(i.boundaryX,s)),o.css({"margin-top":g+"px","margin-left":s+"px"})},s=function(e){if(jse.libs.theme.responsive.breakpoint().id>r.breakpoint){var t=$(this),n=t.data(),o=a.find(".preloader"),s=$("<img />"),h=t.attr("alt"),m=t.attr("title");a.children("img").remove(),o.show(),i.addClass(r.bodyClass),s.one("load",(function(){s.css({height:this.height+"px",width:this.width+"px"}),o.hide(),t.off("mousemove.magnifier").on("mousemove.magnifier",g)})).attr({src:n.magnifierSrc,alt:h,title:m}),a.append(s).show()}},h=function(){n&&(t.find("img[data-magnifier-src]").removeData("magnifier"),n=!1)},m=function(){a.hide(),i.removeClass(r.bodyClass),t.off("mouseenter").on("mouseenter","img[data-magnifier-src]",s)},d=function(){t.off("mouseenter")};return o.init=function(e){a=$(r.target),t.on("touchstart","img[data-magnifier-src]",d).on("mouseenter","img[data-magnifier-src]",s).on("mouseleave","img[data-magnifier-src]",m),$(window).on("resize",h),e()},o}));