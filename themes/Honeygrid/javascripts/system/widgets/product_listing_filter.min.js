"use strict";gambio.widgets.module("product_listing_filter",["url_arguments",gambio.source+"/libs/events"],(function(e){var t=$(this),a=$("body"),i=null,s=null,r=null,n=null,l=null,o=!1,u={},d=$.extend(!0,{},{target:null},e),c={},f=function(e){l.find("a").each((function(){var t=$(this).attr("href");$(this).attr("href",jse.libs.url_arguments.replaceParameterValue(t,"view_mode",e))}))},m=function(e){e&&e.preventDefault();var a,s,l=$(this),d=l.parseModuleData("product_listing_filter"),c=d.urlParam;if(!l.hasClass("active")&&(t.trigger(jse.libs.theme.events.OPEN_FLYOUT(),t),a=d,s="",n.find("a").each((function(){var e=$(this),t=e.parseModuleData("product_listing_filter");a.add!==t.add?(s+=t.add+" ",e.removeClass("active")):e.addClass("active")})),u.open=!1,i.off(jse.libs.theme.events.TRANSITION_FINISHED()).one(jse.libs.theme.events.TRANSITION_FINISHED(),(function(){u.open=!0,i.removeClass(s).addClass(a.add).trigger(jse.libs.theme.events.TRANSITION(),u)})).trigger(jse.libs.theme.events.TRANSITION(),u),f(c),r.val(c),o&&e&&e.data&&e.data.history)){var m=jse.libs.url_arguments.replaceParameterValue(location.href,"view_mode",c);history.pushState({state:c},c,m),t.trigger("pushstate",{state:c})}},g=function(e,a){var i=a||(e.originalEvent?e.originalEvent:{state:""}),s=n.find('[data-product_listing_filter-url-param="'+i.state+'"]');if(s.length&&!a.noButton)m.call(s);else{var r=t.find(".jsPanelViewmode a.active").parseModuleData("product_listing_filter");f(r.urlParam)}},h=function(){s.submit()};return c.init=function(e){if(i=$(d.target),s=t.find("form"),r=s.find('input[name="view_mode"]'),n=t.find(".jsPanelViewmode"),l=t.find(".pagination"),o=jse.core.config.get("history"),u.classClose="fadeOut",o){var c=jse.libs.url_arguments.getUrlParameters().view_mode,f=history.state||{},v=jse.libs.url_arguments.replaceParameterValue(location.href,"view_mode",c);f.state=c,history.replaceState(f,c,v)}t.on("change","select.jsReload",h).on("click",".jsPanelViewmode a",{history:!0},m),a.on("pushstate pushstate_no_history",g),$(window).on("popstate",g),e()},c}));