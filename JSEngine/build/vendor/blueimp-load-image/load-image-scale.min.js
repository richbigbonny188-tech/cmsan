!function(t){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],t):"object"==typeof module&&module.exports?t(require("./load-image")):t(window.loadImage)}((function(t){"use strict";var e=t.transform;t.transform=function(i,o,a,n,r){e.call(t,t.scale(i,o,r),o,a,n,r)},t.transformCoordinates=function(){},t.getTransformedOptions=function(t,e){var i,o,a,n,r=e.aspectRatio;if(!r)return e;for(o in i={},e)Object.prototype.hasOwnProperty.call(e,o)&&(i[o]=e[o]);return i.crop=!0,(a=t.naturalWidth||t.width)/(n=t.naturalHeight||t.height)>r?(i.maxWidth=n*r,i.maxHeight=n):(i.maxWidth=a,i.maxHeight=a/r),i},t.renderImageToCanvas=function(t,e,i,o,a,n,r,h,d,g,m){var c=t.getContext("2d");return!1===m.imageSmoothingEnabled?c.imageSmoothingEnabled=!1:m.imageSmoothingQuality&&(c.imageSmoothingQuality=m.imageSmoothingQuality),c.drawImage(e,i,o,a,n,r,h,d,g),t},t.hasCanvasOption=function(t){return t.canvas||t.crop||!!t.aspectRatio},t.scale=function(e,i,o){i=i||{};var a,n,r,h,d,g,m,c,s,u,f,l=document.createElement("canvas"),v=e.getContext||t.hasCanvasOption(i)&&l.getContext,p=e.naturalWidth||e.width,x=e.naturalHeight||e.height,w=p,C=x;function y(){var t=Math.max((r||w)/w,(h||C)/C);t>1&&(w*=t,C*=t)}function b(){var t=Math.min((a||w)/w,(n||C)/C);t<1&&(w*=t,C*=t)}if(v&&(m=(i=t.getTransformedOptions(e,i,o)).left||0,c=i.top||0,i.sourceWidth?(d=i.sourceWidth,void 0!==i.right&&void 0===i.left&&(m=p-d-i.right)):d=p-m-(i.right||0),i.sourceHeight?(g=i.sourceHeight,void 0!==i.bottom&&void 0===i.top&&(c=x-g-i.bottom)):g=x-c-(i.bottom||0),w=d,C=g),a=i.maxWidth,n=i.maxHeight,r=i.minWidth,h=i.minHeight,v&&a&&n&&i.crop?(w=a,C=n,(f=d/g-a/n)<0?(g=n*d/a,void 0===i.top&&void 0===i.bottom&&(c=(x-g)/2)):f>0&&(d=a*g/n,void 0===i.left&&void 0===i.right&&(m=(p-d)/2))):((i.contain||i.cover)&&(r=a=a||r,h=n=n||h),i.cover?(b(),y()):(y(),b())),v){if((s=i.pixelRatio)>1&&(l.style.width=w+"px",l.style.height=C+"px",w*=s,C*=s,l.getContext("2d").scale(s,s)),(u=i.downsamplingRatio)>0&&u<1&&w<d&&C<g)for(;d*u>w;)l.width=d*u,l.height=g*u,t.renderImageToCanvas(l,e,m,c,d,g,0,0,l.width,l.height,i),m=0,c=0,d=l.width,g=l.height,(e=document.createElement("canvas")).width=d,e.height=g,t.renderImageToCanvas(e,l,0,0,d,g,0,0,d,g,i);return l.width=w,l.height=C,t.transformCoordinates(l,i),t.renderImageToCanvas(l,e,m,c,d,g,0,0,w,C,i)}return e.width=w,e.height=C,e}}));